<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<div layout:fragment="content">
  <div class="auth-wrap">
    <div class="form-card">
      <h2 class="form-title">비밀번호 재설정</h2>
      
      <div th:if="${success}" class="alert alert-success">
        <span th:text="${success}"></span>
      </div>
      
      <div th:if="${error}" class="alert alert-error">
        <span th:text="${error}"></span>
      </div>
      
      <form method="post" th:action="@{/member/reset-password}" th:if="${!success}">
        <input type="hidden" name="token" th:value="${token}">
        
        <div class="form-field">
          <label for="password">새 비밀번호</label>
          <input id="password" name="password" type="password" required 
                 minlength="8" placeholder="영문/숫자 포함, 8자 이상">
        </div>
        
        <div class="form-field">
          <label for="passwordConfirm">비밀번호 확인</label>
          <input id="passwordConfirm" name="passwordConfirm" type="password" required>
          <small id="pwMatchMsg" class="hint"></small>
        </div>
        
        <button type="submit" class="btn-primary w-100">비밀번호 변경</button>
      </form>
      
      <div class="form-meta">
        <a th:href="@{/member/login}">로그인으로 돌아가기</a>
      </div>
    </div>
  </div>
</div>

<script>
document.getElementById('passwordConfirm').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const passwordConfirm = this.value;
    const msgElement = document.getElementById('pwMatchMsg');
    
    if (passwordConfirm && password !== passwordConfirm) {
        msgElement.textContent = '비밀번호가 일치하지 않습니다.';
        msgElement.className = 'hint error';
    } else if (passwordConfirm && password === passwordConfirm) {
        msgElement.textContent = '비밀번호가 일치합니다.';
        msgElement.className = 'hint success';
    } else {
        msgElement.textContent = '';
        msgElement.className = 'hint';
    }
});
</script>